[{"path":"https://zhen-miao.github.io/PACS/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2023 PACS authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"content","dir":"Articles","previous_headings":"","what":"Content","title":"Vignette 1. Cell type annotation with PACS","text":"Vignette contains example conduct cell type annotation PACS. conduct cell type annotation, need reference dataset cell type annotated, new dataset want infer cell type labels cell.","code":""},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"required-libraries","dir":"Articles","previous_headings":"","what":"Required libraries","title":"Vignette 1. Cell type annotation with PACS","text":"Please make sure following libraries installed loaded analysis.","code":"library(\"data.table\") library(\"Matrix\") library(\"PICsnATAC\") library(\"PACS\") library(\"Rfast\")"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"input-files","dir":"Articles","previous_headings":"","what":"Input files","title":"Vignette 1. Cell type annotation with PACS","text":"PACS cell type annotation framework requires following input files: Reference peak cell matrix (ref_mat) Cell type labels reference data (cell_types) Target peak cell matrix want obtain cell type labels (tar_mat) Note, two data matrices set features (peaks), please refer PIC_snATAC package obtaining data matrix. Clustering annotation can conducted Seurat, ArchR, snapATAC, pipelines.","code":""},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"cell-specific-capturing-rate-estimation","dir":"Articles","previous_headings":"","what":"Cell-specific capturing rate estimation","title":"Vignette 1. Cell type annotation with PACS","text":"described manuscript, snATAC-seq data, cell may largely variant capturing rate (sequencing depth), , compute caputuring rate cell separating effect cell type-specific open probability object r_by_ct_out list two elements, p_by_t Peak cell type matrix, element represents open probability peak corresponding cell type q_vec vector cell-specific capturing rate first element input annotating cell type labels new dataset","code":"ctypes <- unique(cell_types) r_by_ct_out <- get_r_by_ct_mat_pq(   cell_type_set = ctypes,   r_by_c = ref_mat,   cell_type_labels = cell_types,   n_features_per_cell = dim(ref_mat)[1] )"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"identify-informative-features","dir":"Articles","previous_headings":"","what":"Identify informative features","title":"Vignette 1. Cell type annotation with PACS","text":"choose subset features informative distinguish different cell types. rule thumb choose features based standard deviation across cell types.","code":"p_sd <- sqrt(Rfast::rowVars(r_by_ct_out$p_by_t)) pk_sel <- p_sd > quantile(p_sd, 0.5) ## top 50% highly variable features"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"cell-type-annotation","dir":"Articles","previous_headings":"","what":"Cell type annotation","title":"Vignette 1. Cell type annotation with PACS","text":"","code":"## get the likelihood for each cell type est_mat <- estimate_label_no_cap_rate(   r_by_t = r_by_ct_out$p_by_t[pk_sel, ],   in_r_by_c = tar_mat[pk_sel, ] )  ## identify the most probable cell type esti_ctype_fir <- Rfast::rownth(est_mat, rep(1, length = dim(est_mat)[1]),   num.of.nths = 1, descending = TRUE,   index.return = TRUE, parallel = FALSE ) esti_ctype_labels <- ctypes[esti_ctype_fir]"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_1_PACS_cell_type_annotation.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"Vignette 1. Cell type annotation with PACS","text":"used PACS analysis, please cite manuscript: Miao, Z., Wang, J., Park, K., Kuang, D., & Kim, J. (2023). Model-based compound hypothesis testing snATAC-seq data PACS. bioRxiv, 2023-07.","code":""},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_2_PACS_differential_test.html","id":"content","dir":"Articles","previous_headings":"","what":"Content","title":"Vignette 2. Differentially Accessible Region (DAR) Identification with PACS","text":"Vignette contains example conduct Differentially Accessible Region (DAR) Identification PACS.","code":""},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_2_PACS_differential_test.html","id":"required-libraries","dir":"Articles","previous_headings":"","what":"Required libraries","title":"Vignette 2. Differentially Accessible Region (DAR) Identification with PACS","text":"Please make sure following libraries installed loaded analysis.","code":"library(\"data.table\") library(\"Matrix\") library(\"PICsnATAC\") library(\"PACS\") library(\"Rfast\")"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_2_PACS_differential_test.html","id":"input-files","dir":"Articles","previous_headings":"","what":"Input files","title":"Vignette 2. Differentially Accessible Region (DAR) Identification with PACS","text":"PACS cell type annotation framework requires following input files: peak cell matrix dataset (data_mat) Metadata (meta_data) include cell type label, batch lable, etc. Note, allow quantitative (0,1,2,3,…) binary (0/1) data input. please note, quantitative data matrix based fragment count paired-insertion count. wonder , please refer PIC_snATAC package manuscript. Clustering annotation can conducted Seurat, ArchR, snapATAC, pipelines.","code":""},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_2_PACS_differential_test.html","id":"cell-specific-capturing-rate-estimation","dir":"Articles","previous_headings":"","what":"Cell-specific capturing rate estimation","title":"Vignette 2. Differentially Accessible Region (DAR) Identification with PACS","text":"described manuscript, snATAC-seq data, cell may largely variant capturing rate (sequencing depth), , compute caputuring rate cell separating effect cell type-specific open probability object r_by_ct_out list two elements, p_by_t Peak cell type matrix, element represents open probability peak corresponding cell type q_vec vector cell-specific capturing rate second element input DAR analysis","code":"ctypes <- unique(cell_types) r_by_ct_out <- get_r_by_ct_mat_pq(   cell_type_set = ctypes,   r_by_c = ref_mat,   cell_type_labels = cell_types,   n_features_per_cell = dim(ref_mat)[1] )"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_2_PACS_differential_test.html","id":"dar-test","dir":"Articles","previous_headings":"","what":"DAR test","title":"Vignette 2. Differentially Accessible Region (DAR) Identification with PACS","text":"need include formula Likelihood Ratio Test (LRT). Assume metadata, two columns, cell_type batch, formula full model null model can specified example: Note, additional optional parameters can set function: n_peaks_per_round number peaks tested round. Can left unspecified, PACS can detect number automatically break R. large dataset, can set value smaller. T_proportion_cutoff Defualt = 0.2, 20%. minimum proportion high density counts (Z>=2) consider cumulative models. enough high density counts, implement binary model faster compute.","code":"p_vals <- pacs_test_sparse(   covariate_meta.data = meta.data,   formula_full = ~ factor(cell_type) + factor(batch),   formula_null = ~ factor(batch),   pic_matrix = data_mat,   cap_rates = r_by_ct_out$q_vec )"},{"path":"https://zhen-miao.github.io/PACS/articles/Vignette_2_PACS_differential_test.html","id":"reference","dir":"Articles","previous_headings":"","what":"Reference","title":"Vignette 2. Differentially Accessible Region (DAR) Identification with PACS","text":"used PACS analysis, please cite manuscript: Miao, Z., Wang, J., Park, K., Kuang, D., & Kim, J. (2023). Model-based compound hypothesis testing snATAC-seq data PACS. bioRxiv, 2023-07.","code":""},{"path":"https://zhen-miao.github.io/PACS/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Zhen Miao. Author, maintainer.","code":""},{"path":"https://zhen-miao.github.io/PACS/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Miao Z (2024). PACS: Probabilistic model Accessible Chromatin data Single Cell. R package version 0.2.1, https://zhen-miao.github.io/PACS/.","code":"@Manual{,   title = {PACS: Probabilistic model for Accessible Chromatin data in Single Cell},   author = {Zhen Miao},   year = {2024},   note = {R package version 0.2.1},   url = {https://zhen-miao.github.io/PACS/}, }"},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"pacs","dir":"","previous_headings":"","what":"Probabilistic model for Accessible Chromatin data in Single Cell","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"Illustration PACS framework.","code":""},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"pacs-probabilistic-model-for-accessible-chromatin-data-in-single-cell","dir":"","previous_headings":"","what":"PACS (Probabilistic model for Accessible Chromatin data in Single Cell)","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"PACS toolkit snATAC-seq data analysis. key functionalities PACS include: Depth correction snATAC-seq data. Statistical test complex data design Supervised cell type annotation (reference dataset) Batch effect correction enabled statistical test framework","code":""},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"can install current version PACS GitHub : installation step take < 5 min standard desktop machine. R version > 4.0.0 recommended (older R version tested).","code":"# install.packages(\"devtools\") devtools::install_github(\"Zhen-Miao/PICsnATAC\") ## dependent package  devtools::install_github(\"Zhen-Miao/PACS\")"},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"basic example shows run PACS common workflow:","code":"library(PACS)  p_vals <- pacs_test_sparse(   covariate_meta.data = meta.data,   formula_full = ~ factor(cell_type) + factor(batch),   formula_null = ~ factor(batch),   pic_matrix = data_mat,   cap_rates = capturing_probability )"},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"vignette-and-interactive-notebooks","dir":"","previous_headings":"","what":"Vignette and Interactive Notebooks","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"interactive tutorial website vignettes can found https://zhen-miao.github.io/PACS/ Although recommended, can also run analysis using Goolge Colab, one example shown : Notebook 1: Type 1 error power evaluation real data .","code":""},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"citation","dir":"","previous_headings":"","what":"Citation:","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"Miao, Z., Wang, J., Park, K. Kuang, D. Kim, J. Model-based compound hypothesis testing snATAC-seq data PACS. bioRxiv (2023). https://www.biorxiv.org/content/10.1101/2023.07.30.551108v1","code":""},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"snatac-seq-toolkits","dir":"","previous_headings":"","what":"snATAC-seq toolkits","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"PACS one snATAC-seq toolkits developed Kim lab. toolkits include: PICsnATAC Miao, Z Kim, J. Uniform quantification single-nucleus ATAC-seq data Paired- Insertion Counting (PIC) model-based insertion rate estimator. Nature Methods 2024","code":""},{"path":"https://zhen-miao.github.io/PACS/index.html","id":"contact","dir":"","previous_headings":"","what":"Contact","title":"Probabilistic model for Accessible Chromatin data in Single Cell","text":"questions regarding package, please contact Zhen Miao (zhenmiao@pennmedicine.upenn.edu) Junhyong Kim (junhyong@sas.upenn.edu).","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/CCT_internal_horizontal.html","id":null,"dir":"Reference","previous_headings":"","what":"Cauchy Combination Test accelerated — CCT_internal_horizontal","title":"Cauchy Combination Test accelerated — CCT_internal_horizontal","text":"adopted Liu Xie JASA 2020 publication GitHub page. Please also cite initial publication used part codes. Thaks!","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/CCT_internal_horizontal.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Cauchy Combination Test accelerated — CCT_internal_horizontal","text":"","code":"CCT_internal_horizontal(pval_mat)"},{"path":"https://zhen-miao.github.io/PACS/reference/CCT_internal_horizontal.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Cauchy Combination Test accelerated — CCT_internal_horizontal","text":"pval_mat matrix p values row feature column p value one individual test, want compute aggregated p values row","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/CCT_internal_horizontal.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Cauchy Combination Test accelerated — CCT_internal_horizontal","text":"vector p value feature Cauchy combination","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/compare_models.html","id":null,"dir":"Reference","previous_headings":"","what":"Use gLRT to compare two models and obtain p values — compare_models","title":"Use gLRT to compare two models and obtain p values — compare_models","text":"Use gLRT compare two models obtain p values","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/compare_models.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Use gLRT to compare two models and obtain p values — compare_models","text":"","code":"compare_models(   x_full,   theta_estimated_full,   x_null,   theta_estimated_null,   q_vec,   c_by_r,   df_test,   mc.cores = 1 )"},{"path":"https://zhen-miao.github.io/PACS/reference/compare_models.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Use gLRT to compare two models and obtain p values — compare_models","text":"x_full Design matrix full model theta_estimated_full Estimated coefficients full model x_null Design matrix null model theta_estimated_null Estimated coefficients null model q_vec vector capturing probability cell c_by_r Cell region matrix df_test Degree freedom test mc.cores Number cores multi-core computing","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/compare_models.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Use gLRT to compare two models and obtain p values — compare_models","text":"vector p values based gLRT","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/compute_infor_mat_tilda.html","id":null,"dir":"Reference","previous_headings":"","what":"compute_information matrix tilda — compute_infor_mat_tilda","title":"compute_information matrix tilda — compute_infor_mat_tilda","text":"compute_information matrix tilda","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/compute_infor_mat_tilda.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"compute_information matrix tilda — compute_infor_mat_tilda","text":"","code":"compute_infor_mat_tilda(xdumm, p_bg, q_vec, y_vec)"},{"path":"https://zhen-miao.github.io/PACS/reference/compute_infor_mat_tilda.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"compute_information matrix tilda — compute_infor_mat_tilda","text":"xdumm design matrix, X p_bg open probability vector q_vec vector capturing probability y_vec vector observed open (1) close (0) state cell, must match length q","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/compute_infor_mat_tilda.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"compute_information matrix tilda — compute_infor_mat_tilda","text":"information matrix tilda","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_default.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate cell type label for new data — estimate_label_default","title":"Estimate cell type label for new data — estimate_label_default","text":"Estimate cell type label new data","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_default.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate cell type label for new data — estimate_label_default","text":"","code":"estimate_label_default(r_by_t, in_r_by_c, alpha = 1)"},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_default.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate cell type label for new data — estimate_label_default","text":"r_by_t Region-cell type matrix generated annotated dataset in_r_by_c Input (unannotated) region cell matrix alpha Weight negative peaks, default = 1","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_default.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate cell type label for new data — estimate_label_default","text":"matrix cell types cell matrix, elements representing probability cell type","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_no_cap_rate_all_pks.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate cell type label for new data using all peaks as input — estimate_label_no_cap_rate_all_pks","title":"Estimate cell type label for new data using all peaks as input — estimate_label_no_cap_rate_all_pks","text":"identify relevant peaks","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_no_cap_rate_all_pks.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate cell type label for new data using all peaks as input — estimate_label_no_cap_rate_all_pks","text":"","code":"estimate_label_no_cap_rate_all_pks(r_by_t, in_r_by_c, pks_sel, alpha = 1)"},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_no_cap_rate_all_pks.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate cell type label for new data using all peaks as input — estimate_label_no_cap_rate_all_pks","text":"r_by_t Region-cell type matrix generated annotated dataset in_r_by_c Input (unannotated) region cell matrix pks_sel selected peaks informative cell type label prediction alpha Weight negative peaks, default = 1","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_label_no_cap_rate_all_pks.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate cell type label for new data using all peaks as input — estimate_label_no_cap_rate_all_pks","text":"matrix cell types cell matrix, elements representing probability cell type","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate parameters for the full model — estimate_parameters","title":"Estimate parameters for the full model — estimate_parameters","text":"Estimate parameters full model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate parameters for the full model — estimate_parameters","text":"","code":"estimate_parameters(   r_by_c,   design_mat,   par_initial,   cap_rate_vec,   mc.cores = 1 )"},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate parameters for the full model — estimate_parameters","text":"r_by_c Region cell matrix design_mat Desing matrix par_initial Initialized parameters cap_rate_vec vector capturing probability mc.cores Number multi-cores, default = 1","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate parameters for the full model — estimate_parameters","text":"Estimated coefficient full model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate parameters for the null model — estimate_parameters_null","title":"Estimate parameters for the null model — estimate_parameters_null","text":"Estimate parameters null model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate parameters for the null model — estimate_parameters_null","text":"","code":"estimate_parameters_null(   r_by_c,   design_mat,   par_initial,   hold_zero,   cap_rate_vec,   mc.cores = 1 )"},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate parameters for the null model — estimate_parameters_null","text":"r_by_c Region cell matrix design_mat Desing matrix par_initial Initialized parameters hold_zero parameter hold zero estimation cap_rate_vec vector capturing probability mc.cores Number multi-cores, default = 1","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/estimate_parameters_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate parameters for the null model — estimate_parameters_null","text":"Estimated coefficient null model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/infor_mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Information matrix -- original without Firth prior — infor_mat","title":"Information matrix -- original without Firth prior — infor_mat","text":"Information matrix -- original without Firth prior","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/infor_mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Information matrix -- original without Firth prior — infor_mat","text":"","code":"infor_mat(xdumm, p_bg, q_vec)"},{"path":"https://zhen-miao.github.io/PACS/reference/infor_mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Information matrix -- original without Firth prior — infor_mat","text":"xdumm design matrix, X dummy variables p_bg vector open probability q_vec vector capturing rates","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/infor_mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Information matrix -- original without Firth prior — infor_mat","text":"information matrix","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter.html","id":null,"dir":"Reference","previous_headings":"","what":"Iteratively reweighted least squares function (main function) — irls_iter","title":"Iteratively reweighted least squares function (main function) — irls_iter","text":"Iteratively reweighted least squares function (main function)","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iteratively reweighted least squares function (main function) — irls_iter","text":"","code":"irls_iter(   y_vec,   xdumm,   theta_estimated,   tolerance = .Machine$double.eps^0.5,   stop_criteria = 1e-06,   q_vec )"},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iteratively reweighted least squares function (main function) — irls_iter","text":"y_vec Observed counts xdumm Design matrix theta_estimated Estimated coefficient values tolerance Numeric tolerance matrix considered revertable, default = .Machine$double.eps^0.5 stop_criteria Resolution stop, default = 1e-6 q_vec Capturing probability vector","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iteratively reweighted least squares function (main function) — irls_iter","text":"Converged coefficient estimate","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt.html","id":null,"dir":"Reference","previous_headings":"","what":"Iteratively reweighted least squares function -- newton methods — irls_iter_nt","title":"Iteratively reweighted least squares function -- newton methods — irls_iter_nt","text":"Iteratively reweighted least squares function -- newton methods","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iteratively reweighted least squares function -- newton methods — irls_iter_nt","text":"","code":"irls_iter_nt(   y_vec,   xdumm,   theta_estimated,   tolerance = .Machine$double.eps^0.5,   stop_criteria = 1e-05,   q_vec )"},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iteratively reweighted least squares function -- newton methods — irls_iter_nt","text":"y_vec Observed counts xdumm Design matrix theta_estimated Estimated coefficient values tolerance Numeric tolerance matrix considered revertable, default = .Machine$double.eps^0.5 stop_criteria Resolution stop, default = 1e-6 q_vec Capturing probability vector","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iteratively reweighted least squares function -- newton methods — irls_iter_nt","text":"Converged coefficient estimate","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Iteratively reweighted least squares function for null -- newton method\nfor the null model — irls_iter_nt_null","title":"Iteratively reweighted least squares function for null -- newton method\nfor the null model — irls_iter_nt_null","text":"Iteratively reweighted least squares function null -- newton method null model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iteratively reweighted least squares function for null -- newton method\nfor the null model — irls_iter_nt_null","text":"","code":"irls_iter_nt_null(   y_vec,   xdumm,   theta_estimated,   hold_zero,   tolerance = .Machine$double.eps^0.5,   stop_criteria = 1e-05,   q_vec )"},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iteratively reweighted least squares function for null -- newton method\nfor the null model — irls_iter_nt_null","text":"y_vec Observed counts xdumm Design matrix theta_estimated Estimated coefficient values hold_zero element hold zero null model tolerance Numeric tolerance matrix considered revertable, default = .Machine$double.eps^0.5 stop_criteria Resolution stop, default = 1e-6 q_vec Capturing probability vector","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_nt_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iteratively reweighted least squares function for null -- newton method\nfor the null model — irls_iter_nt_null","text":"Converged coefficient estimate null model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_null.html","id":null,"dir":"Reference","previous_headings":"","what":"Iteratively reweighted least squares function (main function) for the\nnull model — irls_iter_null","title":"Iteratively reweighted least squares function (main function) for the\nnull model — irls_iter_null","text":"Iteratively reweighted least squares function (main function) null model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_null.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Iteratively reweighted least squares function (main function) for the\nnull model — irls_iter_null","text":"","code":"irls_iter_null(   y_vec,   xdumm,   theta_estimated,   tolerance = .Machine$double.eps^0.5,   hold_zero,   stop_criteria = 1e-06,   q_vec )"},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_null.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Iteratively reweighted least squares function (main function) for the\nnull model — irls_iter_null","text":"y_vec Observed counts xdumm Design matrix theta_estimated Estimated coefficient values tolerance Numeric tolerance matrix considered revertable, default = .Machine$double.eps^0.5 hold_zero element hold zero null model stop_criteria Resolution stop, default = 1e-6 q_vec Capturing probability vector","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/irls_iter_null.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Iteratively reweighted least squares function (main function) for the\nnull model — irls_iter_null","text":"Converged coefficient estimate null model","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_firth_from_wii.html","id":null,"dir":"Reference","previous_headings":"","what":"Compute loss function with Firth regularization from Wii matrix — loss_firth_from_wii","title":"Compute loss function with Firth regularization from Wii matrix — loss_firth_from_wii","text":"Compute loss function Firth regularization Wii matrix","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_firth_from_wii.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Compute loss function with Firth regularization from Wii matrix — loss_firth_from_wii","text":"","code":"loss_firth_from_wii(wii_sqrt, xdumm)"},{"path":"https://zhen-miao.github.io/PACS/reference/loss_firth_from_wii.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Compute loss function with Firth regularization from Wii matrix — loss_firth_from_wii","text":"wii_sqrt square root Wii diagonal elements vector xdumm Design matrix","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_firth_from_wii.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Compute loss function with Firth regularization from Wii matrix — loss_firth_from_wii","text":"Regularized log loss value","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate Loss Function without Firth prior — loss_fun","title":"Calculate Loss Function without Firth prior — loss_fun","text":"Calculate Loss Function without Firth prior","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate Loss Function without Firth prior — loss_fun","text":"","code":"loss_fun(p_bg, q_vec, y_vec)"},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate Loss Function without Firth prior — loss_fun","text":"p_bg vector open probability cell type group g q_vec vector capturing rates y_vec vector observed open (1) close (0) state cell, must match length q","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate Loss Function without Firth prior — loss_fun","text":"Log loss value without Firth prior","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun_star.html","id":null,"dir":"Reference","previous_headings":"","what":"Regularized log loss function — loss_fun_star","title":"Regularized log loss function — loss_fun_star","text":"Regularized log loss function","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun_star.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Regularized log loss function — loss_fun_star","text":"","code":"loss_fun_star(xdumm, p_bg, q_vec, y_vec)"},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun_star.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Regularized log loss function — loss_fun_star","text":"xdumm Observed counts p_bg Vector open probability q_vec Capturing probability vector y_vec Observed counts","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_fun_star.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Regularized log loss function — loss_fun_star","text":"Regularized log loss","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_grad_pen.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of penalized loss ( Invariant prior) — loss_grad_pen","title":"Gradient of penalized loss ( Invariant prior) — loss_grad_pen","text":"Gradient penalized loss ( Invariant prior)","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_grad_pen.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of penalized loss ( Invariant prior) — loss_grad_pen","text":"","code":"loss_grad_pen(xdumm, p_bg, q_vec, inf_mat, wii_sqrt_X)"},{"path":"https://zhen-miao.github.io/PACS/reference/loss_grad_pen.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of penalized loss ( Invariant prior) — loss_grad_pen","text":"xdumm design matrix, X p_bg value open probability q_vec vector capturing probability inf_mat Information matrix wii_sqrt_X sqrt(wii) vector times design matrix","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_grad_pen.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of penalized loss ( Invariant prior) — loss_grad_pen","text":"Gradient penalized loss ( Invariant prior)","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_gradient.html","id":null,"dir":"Reference","previous_headings":"","what":"Gradient of loss function without Firth prior — loss_gradient","title":"Gradient of loss function without Firth prior — loss_gradient","text":"Gradient loss function without Firth prior","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_gradient.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Gradient of loss function without Firth prior — loss_gradient","text":"","code":"loss_gradient(xdumm, p_bg, q_vec, y_vec)"},{"path":"https://zhen-miao.github.io/PACS/reference/loss_gradient.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Gradient of loss function without Firth prior — loss_gradient","text":"xdumm design matrix, X dummy variables p_bg value open probability q_vec vector capturing rates y_vec vector observed open (1) close (0) state cell, must match length q","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/loss_gradient.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Gradient of loss function without Firth prior — loss_gradient","text":"first order derivative loss function without Firth prior, vector","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/our_method_no_firth.html","id":null,"dir":"Reference","previous_headings":"","what":"Internal evaluation use only -- PACS Without Firth — our_method_no_firth","title":"Internal evaluation use only -- PACS Without Firth — our_method_no_firth","text":"Internal evaluation use -- PACS Without Firth","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/our_method_no_firth.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Internal evaluation use only -- PACS Without Firth — our_method_no_firth","text":"","code":"our_method_no_firth(data_matrix_pos, data_matrix_neg, true_q_pos, true_q_neg)"},{"path":"https://zhen-miao.github.io/PACS/reference/our_method_no_firth.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Internal evaluation use only -- PACS Without Firth — our_method_no_firth","text":"data_matrix_pos Count matrix foreground group data_matrix_neg Count matrix background group true_q_pos Capturing probability vector foreground group true_q_neg Capturing probability vector background group","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/our_method_no_firth.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Internal evaluation use only -- PACS Without Firth — our_method_no_firth","text":"P values cell","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_cumu.html","id":null,"dir":"Reference","previous_headings":"","what":"likelihood ratio test with PACS -- cumulative logit — pacs_test_cumu","title":"likelihood ratio test with PACS -- cumulative logit — pacs_test_cumu","text":"likelihood ratio test PACS -- cumulative logit","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_cumu.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"likelihood ratio test with PACS -- cumulative logit — pacs_test_cumu","text":"","code":"pacs_test_cumu(   covariate_meta.data,   formula_full,   formula_null,   pic_matrix,   max_T = 2,   cap_rates,   par_initial_null = NULL,   par_initial_full = NULL,   n_cores = 1 )"},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_cumu.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"likelihood ratio test with PACS -- cumulative logit — pacs_test_cumu","text":"covariate_meta.data data.frame columns representing covariates rows representing cells formula_full formula object representing full model. example, ~ cell_type + batch formula_null formula object representing null model. example, ~ batch pic_matrix input region--cell PIC matrix max_T maximum value accessibility considered, default = 2 cap_rates vector capturing probability cell par_initial_null Initialized values estimated parameters null model, need specify unless reasons . Default = NULL par_initial_full Initialized values estimated parameters null model, need specify unless reasons . Default = NULL n_cores number cores multi-core computation","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_cumu.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"likelihood ratio test with PACS -- cumulative logit — pacs_test_cumu","text":"list two elements, pacs_converged vector length 2*n_peaks representing convergence status peak null full model pacs_p_val vector length n_peaks representing p values peak.","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_logit.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile likelihood ratio test with PACS — pacs_test_logit","title":"Profile likelihood ratio test with PACS — pacs_test_logit","text":"Profile likelihood ratio test PACS","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_logit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile likelihood ratio test with PACS — pacs_test_logit","text":"","code":"pacs_test_logit(   covariate_meta.data,   formula_full,   formula_null,   pic_matrix,   cap_rates,   par_initial_null = NULL,   par_initial_full = NULL,   n_cores = 1 )"},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_logit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile likelihood ratio test with PACS — pacs_test_logit","text":"covariate_meta.data data.frame columns representing covariates rows representing cells formula_full formula object representing full model. example, ~ cell_type + batch formula_null formula object representing null model. example, ~ batch pic_matrix input region--cell PIC matrix cap_rates vector capturing probability cell par_initial_null Initialized values estimated parameters null model, need specify unless reasons . Default = NULL par_initial_full Initialized values estimated parameters null model, need specify unless reasons . Default = NULL n_cores number cores multi-core computation","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_logit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile likelihood ratio test with PACS — pacs_test_logit","text":"list two elements, pacs_converged vector length 2*n_peaks representing convergence status peak null full model pacs_p_val vector length n_peaks representing p values peak.","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_sparse.html","id":null,"dir":"Reference","previous_headings":"","what":"Profile likelihood ratio test with PACS — pacs_test_sparse","title":"Profile likelihood ratio test with PACS — pacs_test_sparse","text":"Profile likelihood ratio test PACS","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_sparse.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Profile likelihood ratio test with PACS — pacs_test_sparse","text":"","code":"pacs_test_sparse(   covariate_meta.data,   formula_full,   formula_null,   pic_matrix,   n_peaks_per_round = NULL,   T_proportion_cutoff = 0.2,   cap_rates,   par_initial_null = NULL,   par_initial_full = NULL,   n_cores = 1,   verbose = TRUE )"},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_sparse.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Profile likelihood ratio test with PACS — pacs_test_sparse","text":"covariate_meta.data data.frame columns representing covariates rows representing cells formula_full formula object representing full model. example, ~ cell_type + batch formula_null formula object representing null model. example, ~ batch pic_matrix input region--cell PIC matrix n_peaks_per_round number peaks tested round. Default = NULL, determined maximum allowable size matrix R. T_proportion_cutoff determine maximum value T, set criteria based proportion reads >= T. parameter set proportion. Default = 0.2 cap_rates vector capturing probability cell par_initial_null Initialized values estimated parameters null model, need specify unless reasons . Default = NULL par_initial_full Initialized values estimated parameters null model, need specify unless reasons . Default = NULL n_cores number cores multi-core computation verbose Whether print progress, default = TRUE","code":""},{"path":"https://zhen-miao.github.io/PACS/reference/pacs_test_sparse.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Profile likelihood ratio test with PACS — pacs_test_sparse","text":"list two elements, pacs_converged vector length 2*n_peaks representing convergence status peak null full model pacs_p_val vector length n_peaks representing p values peak.","code":""}]
